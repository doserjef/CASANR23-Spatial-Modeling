
% \titlegraphic{\hfill\includegraphics[height=1.5cm]{logo.pdf}}

\input{frontStuff.tex}

\title[]{Spatial Factor Models for Multivariate Spatial Data}
\input{authors2.tex}

\begin{document}

\maketitle

\begin{frame}{Multivariate spatial data}

\begin{itemize}
\item Point-referenced spatial data often come as multivariate measurements at each location.\pause

\item Examples:
\begin{itemize}
	\item \red{Environmental monitoring}: stations yield measurements on ozone, NO, CO, and $\text{PM}_{2.5}$.\pause
	\item \red{Community Ecology}: assemblages/communities of species \pause
	\item \red{Forestry}: measurements of stand characteristics age, total biomass, and average tree diameter.\pause
	\item \red{Atmospheric modeling}: at a given site we observe surface temperature, precipitation and wind speed \pause
\end{itemize}

\item We anticipate dependence between measurements %\pause
\begin{itemize}
\item at a particular location%\pause
\item across locations
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Multivariate spatial generalized linear model}

\begin{itemize}
    \item Spatial generalized linear model for $m$-variate spatial data for $j = 1, 2, \dots, m$ and $i = 1, \dots, n$: 
    \begin{align*}
	    y_j(\bs_i) &\sim f(\mu_j(\bs_i), \tau_j) \\
	    \mu_j(\bs_i) &= g^{-1}(\eta_j(\bs_i)) = \bx(\bs_i)^\top\bbeta_j + \text{w}^\ast_j(\bs_i)
    \end{align*}
    \item We can imagine modeling $\bw^\ast(\bs_i) = (\text{w}^\ast_1(\bs_i), \text{w}^\ast_2(\bs_i), \ldots, \text{w}^\ast_m(\bs_i))'$ as an $m$-variate Gaussian process \pause
    \item Could model using Multivariate NNGP as disussed previously with SVCs, works well when $m < 5$. \pause
    \item But what about when $m$ is large (e.g,. 10, 100)?
\end{itemize}
\end{frame}

\begin{frame}{Spatial Factor Model}
    \begin{itemize}
    \item Approximates the dependence between multivariate (spatially-dependent) outcomes through a linear combination of a (much) lower-dimensional set of spatial factors \pause
    \item We represent the $m \times 1$ vector $\bw^\ast(\bs_i)$ as a linear combination of latent spatial factors and factor loadings: 
	    \begin{align*}
                 \bw^\ast(\bs) = \bLambda\bw(\bs_i)
	    \end{align*}
    \item $\bLambda$ is an $m \times q$ loadings matrix (tall and skinny) and $\bw(\bs_j)$ is a $q \times 1$ vector of realizations from $q$ independent spatial GPs \pause
    \item In traditional factor analysis, $\bw(\bs_i)$ are realizations from independent standard normal random variables.
    \end{itemize}
\end{frame}

\begin{frame}{Spatial Factor Model}
   \begin{itemize}
        \item Choosing $q << m$ leads to substantial computational reductions.
	\item Simple to code: just sample from $q$ independent GPs as with basic univariate models.
	\item Yields a non-separable multivariate cross-covariance function given by $\sum_{k = 1}^q\bR_k(\phi_k)\blambda_k\blambda_k^\top$
	\item Can simply replace the $q$ full GPs with their corresponding NNGPs to yield a spatial factor NNGP model
	\item Identifiability constraints on $\bLambda$: fix upper triangle to 0 and diagonal to 1. See Ren and Banerjee (2013) \textit{Biometrics}
   \end{itemize}
\end{frame}

\begin{frame}{Priors}
    \begin{itemize}
	    \item Standard normal priors for the lower triangle of $\bLambda$
	    \item We like to model response-specific regression coefficients $\bbeta_j$ hierarchically. For each $r = 1, \dots, p$ covariate, we model $\beta_{j, r}$ following
		    \begin{align*}
			    \beta_{j, r} \sim N(\mu_{\beta_r}, \tau^2_{\beta_r})
		    \end{align*}
	    \item Gaussian hyperpriors for $\mu_{\beta_r}$ and IG or half-Cauchy priors for $\tau^2_{\beta_r}$
	    \item Independent uniform priors for spatial decay parameters $\bphi$
    \end{itemize}
\end{frame}

\begin{frame}{Why we like spatial factor models}
    \begin{itemize}
         \item Simple to code (don't need to deal with cross-covariance matrices). \pause
	 \item Relatively fast and efficient (well, at least for Gaussian and Binomial). \pause
	 \item Factors and factor loadings can be used for model-based ordination. \pause
	 \item Straightforward extensions to spatially-varying coefficient models.
    \end{itemize}
\end{frame}

\begin{frame}{Example: bird communities across the continental US}
	\begin{center}
             \includegraphics[width=11cm]{../figures/Fig1.pdf}
	\end{center}
\end{frame}

\begin{frame}{Example: bird communities across the continental US}
    Visualization of the first spatial factor and corresponding factor loadings
	\begin{center}
             \includegraphics[width=11cm]{../figures/FigS1.pdf}
	\end{center}
\end{frame}

\begin{frame}{Some downsides to spatial factor models}
     \begin{itemize}
	     \item Convergence assessment is not always straightforward
	     \item Sensitivity to initial values 
	     \item Order of the first $q$ species has important implications for convergence and mixing.
	     \item Assume a multivariate stochastic process can be represented as a linear combination of independent univariate processes
     \end{itemize}
\end{frame}

\begin{frame}{Software}
   \begin{itemize}
        \item \texttt{spOccupancy}: spatial NNGP and non-spatial factor models for binary data
	\item \texttt{spAbundance}: Gaussian, Poisson, and NB spatial NNGP and non-spatial factor models.
	\item \texttt{boral}: many distributions for non-spatial and spatial factor models (Hui 2015 \textit{MEE}; spatial use full GPs fit in JAGS)
	\item \texttt{Hmsc}: spatial models using NNGPs (Tikhonov et al. 2019; \textit{MEE})
	\item \texttt{spBFA}: a variety of spatial models with some nifty priors (Berchuck et al. 2022 \textit{Bayesian Analysis})
   \end{itemize}
\end{frame}

\begin{frame}{Exercise}
	Modeling the distribution of 10 tree species across Vermont
\end{frame}

\end{document}
