
% \titlegraphic{\hfill\includegraphics[height=1.5cm]{logo.pdf}}

\input{frontStuff.tex}

\title[]{Modeling non-Gaussian spatial data}
\input{authors2.tex}

\begin{document}

\maketitle

\begin{frame}{Non-Gaussian spatial data}

\begin{itemize}
	\item Often data sets preclude Gaussian modeling: $y(\bs)$ may not even be continuous
        \item Examples: 
             \begin{itemize}
		     \item Binary: presence or absence of a species at location s.
                     \item Count: abundance of a species at location s.
                     \item Categorical: counts of trees by size class at location s.  
             \end{itemize}
     \item Replace Gaussian likelihood by exponential family member (Diggle, Tawn, and Moyeed (1998)).
\end{itemize}
\end{frame}
 

\begin{frame}{Hierarchical Bayesian approach}
     \begin{itemize}
	     \item \textbf{First stage}: $y(\bs_i)$ are conditionally independent given
		     $\bbeta$ and $\text{w}(\bs_i)$. Here we use a canonical link function, say $g(E[y(\bs_i)]) = \eta(\bs_i) =\bx(\bs_i)'\bbeta+\text{w}(\bs_i)$. \pause
	     \item \textbf{Second stage}: Model $\text{w}(\bs_i)$ as a Gaussian process:
		     $$ \bw \sim N(\bzero,\sigma^2\bR(\phi))$$ \pause
	     \item \textbf{Third stage}: Priors and hyperpriors.
     \end{itemize}

\end{frame}

\begin{frame}{MCMC sampling for spatial GLMMs}
     \begin{itemize}
	     \item Additional GLMM flexibility comes at a computational cost: lose conjugacy of $\bbeta, \bw$
	     \item Requires more Metroplis steps. Particularly costly for $\bw$
	     \item Practical consequence: slower, less efficient algorithms
	     \item Prediction and interpolation proceed as with the Gaussian case
     \end{itemize}
\end{frame}

\begin{frame}{\pg data augmentation}
    \begin{itemize}
	    \item General approach for Bayesian (spatial) logistic regression that yields conjugate updates of $\bbeta$ (and $\bw$) \pause
	    \item Introduce augmented data $\omega(s_i)$ for each $i = 1, \dots, n$, where $\omega(s_i) \sim \text{PG}(N(\bs_i), 0)$, with $N(\bs_i)$ the Binomial weights \pause
	    \item Define $\kappa(\bs_i) = y(\bs_i) - N(\bs_i)/2$ \pause
	    \item Resulting Gibbs sampler is remarkably similar to that of a Gaussian model with response $y(\bs_i)^\ast = \kappa(\bs_i)/\omega(\bs_i)$ and heteroskedastic variances $\tau^2(\bs_i) = 1/\omega(\bs_i)$. \pause
	    \item \textbf{See Polson, Scott, Windle (2013) JASA}
    \end{itemize}
\end{frame}

\begin{frame}{Example: Binary spatial regression}
     \begin{itemize}
          \item Objective: predict the distribution of Loggerhead Shrike across the US
          \begin{align*}
              y(\bs_i) &\sim \text{Bernoulli}(\psi(\bs_i)) \\
                  \text{logit}(\psi(\bs_i)) &= \bx(\bs_i)^\top\bbeta + w(\bs_i) \\
                  \textbf{w} &\sim N(\bzero, \sigma^2\bR(\phi)) \\
                  \bbeta &\sim N(\bmu_{\beta}, \bSigma_{\beta}) \\
                  \sigma^2 &\sim IG(a_\sigma, b_\sigma) \\ 
                  \phi &\sim \text{Uniform}(l, u)
          \end{align*}
          \item For binomial data, we can use a \pg data augmentation approach
     \end{itemize}
\end{frame}

\begin{frame}{Example: Binary spatial regression}
     \begin{center}
          % \includegraphics[scale=0.35, trim={0 1cm 1cm 2cm}, clip]{../figures/LOSH-plot.png}
          \includegraphics[width=11cm]{../figures/LOSH-plot.png}
     \end{center}

\end{frame}

\begin{frame}{Some practical considerations}
     \begin{itemize}
          \item Priors for $\sigma^2$ and $\phi$ may need to be more informative, particularly for binary data. 
	  \item Be careful with non-identity link functions when thinking about priors.
	  \item \pg data augmentation works really for binomial data. Computational cost increases as Binomial weights increases.
	  \item \pg data augmentation also applicable for Negative Binomial count data, but slow for large counts and can be unstable.
     \end{itemize}

\end{frame}
 
\begin{frame}{Software}
     \begin{itemize}
          \item \texttt{spBayes}
               \begin{itemize}
		    \item Univariate and multivariate, full GPs or predictive processes 
                    \item Gaussian, Binomial (no \pg data augmentation), Poisson
	       \end{itemize}
       \item \texttt{spNNGP} 
	       \begin{itemize}
                    \item Univariate, NNGPs
		    \item Gaussian, Binomial
	       \end{itemize}
       \item \texttt{spOccupancy}
	       \begin{itemize}
                    \item Univariate and multivariate, focus on modeling wildlife distributions, full GPs or NNGPs
		    \item Bernoulli
	       \end{itemize}
       \item \texttt{spAbundance}  (\url{https://github.com/doserjef/spAbundance})
	       \begin{itemize}
                    \item Univariate and multivariate, focus on modeling wildlife/plant abundance, NNGPs
		    \item Gaussian, Poisson, Negative Binomial
	       \end{itemize}
     \end{itemize}
\end{frame}
 
\end{document}
